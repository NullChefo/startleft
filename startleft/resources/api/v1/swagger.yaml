---
openapi: 3.0.2
info:
  title: StartLeft API
  version: 1.0.0
  description: "StartLeft is an automation tool for generating Threat Models written in the Open Threat Model (OTM) format from a variety of different sources such as IaC files, diagrams or projects exported from Threat Modelling tools."
  contact:
    name: "StartLeft GitHub"
    url: https://github.com/iriusrisk/startleft/issues
  license:
    name: "Apache-2.0 license"
    url: https://github.com/iriusrisk/startleft/blob/main/LICENSE
paths:
  "/health":
    get:
      tags:
        - health
      summary: Health
      operationId: health_health_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  "/api/v1/startleft/iac":
    post:
      tags:
        - IaC
      summary: IaC to OTM
      description: It generates an OTM from an IaC file
      operationId: iac_api_v1_startleft_iac_post
      requestBody:
        content:
          multipart/form-data:
            schema:
              required:
                - iac_file
                - iac_type
                - id
                - name
                - mapping_file
              type: object
              properties:
                iac_file:
                  title: Iac File
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Files that contains Iac definitions to be merged into one data
                    structure
                iac_type:
                  "$ref": "#/components/schemas/IacType"
                id:
                  title: Id
                  type: string
                  description: ID of the new project
                name:
                  title: Name
                  type: string
                  description: Name of the new project
                mapping_file:
                  title: Mapping File
                  type: string
                  description: File that contains the mapping between IaC resources and threat
                    model resources
                  format: binary
        required: true
      responses:
        '201':
          description: Provided source file has been successfully processed and a
            new OTM file has been created
          content:
            application/json:
              schema: {}
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        '401':
          description: Authentication information is missing, invalid or not granted
            to perform this action
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        '403':
          description: Forbidden operation
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        default:
          description: Unexpected API error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
  "/api/v1/startleft/diagram":
    post:
      tags:
        - Diagram
      summary: Diagram to OTM
      description: It generates an OTM from an diagram file
      operationId: diagram_api_v1_startleft_diagram_post
      requestBody:
        content:
          multipart/form-data:
            schema:
              required:
                - diag_file
                - diag_type
                - id
                - name
                - default_mapping_file
              type: object
              properties:
                diag_file:
                  title: Diag File
                  type: string
                  description: File that contains the diagram definition
                  format: binary
                diag_type:
                  "$ref": "#/components/schemas/DiagramType"
                id:
                  title: Id
                  type: string
                  description: ID of the new project
                name:
                  title: Name
                  type: string
                  description: Name of the new project
                default_mapping_file:
                  title: Default Mapping File
                  type: string
                  description: File that contains the default mapping file
                  format: binary
                custom_mapping_file:
                  title: Custom Mapping File
                  type: string
                  description: File that contains the user custom mapping file
                  format: binary
        required: true
      responses:
        '201':
          description: Provided source file has been successfully processed and a
            new OTM file has been created
          content:
            application/json:
              schema: {}
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        '401':
          description: Authentication information is missing, invalid or not granted
            to perform this action
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        '403':
          description: Forbidden operation
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        default:
          description: Unexpected API error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
  "/api/v1/startleft/external-threat-model":
    post:
      tags:
        - Threat Model
      summary: External Threat Model to OTM
      description: It generates an OTM from another threat models formats
      operationId: etm_api_v1_startleft_external_threat_model_post
      requestBody:
        content:
          multipart/form-data:
            schema:
              required:
                - source_file
                - source_type
                - id
                - name
                - default_mapping_file
              type: object
              properties:
                source_file:
                  title: Source File
                  type: string
                  description: File that contains the original Threat model
                  format: binary
                source_type:
                  "$ref": "#/components/schemas/EtmType"
                id:
                  title: Id
                  type: string
                  description: ID of the new project
                name:
                  title: Name
                  type: string
                  description: Name of the new project
                default_mapping_file:
                  title: Default Mapping File
                  type: string
                  description: File that contains the default mapping file
                  format: binary
                custom_mapping_file:
                  title: Custom Mapping File
                  type: string
                  description: File that contains the user custom mapping file
                  format: binary
        required: true
      responses:
        '201':
          description: Provided source file has been successfully processed and a
            new OTM file has been created
          content:
            application/json:
              schema: {}
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        '401':
          description: Authentication information is missing, invalid or not granted
            to perform this action
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        '403':
          description: Forbidden operation
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
        default:
          description: Unexpected API error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponse"
components:
  schemas:
    ErrorResponse:
      title: ErrorResponse
      required:
        - status
        - error_type
        - title
        - detail
      type: object
      properties:
        status:
          title: Status
          type: string
        error_type:
          title: Error Type
          type: string
        title:
          title: Title
          type: string
        detail:
          title: Detail
          type: string
        errors:
          title: Errors
          type: array
          items:
            "$ref": "#/components/schemas/ErrorResponseItem"
          default: []
    ErrorResponseItem:
      title: ErrorResponseItem
      required:
        - errorMessage
      type: object
      properties:
        errorMessage:
          title: Errormessage
          type: string
    EtmType:
      title: EtmType
      enum:
        - MTMT
      type: string
      description: Type of ETM file
    IacType:
      title: IacType
      enum:
        - CLOUDFORMATION
        - TERRAFORM
      type: string
      description: Type of IaC file
    DiagramType:
      title: DiagramType
      enum:
        - VISIO
        - LUCID
      type: string
      description: Type of Diagram file
